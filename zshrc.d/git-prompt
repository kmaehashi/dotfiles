autoload -U colors; colors
setopt prompt_subst
RPROMPT='$(git_rprompt)'

git_rprompt() {
  local branch color
  branch="$(git rev-parse --abbrev-ref HEAD || echo '')" &> /dev/null
  [ -z "${branch}" ] && return
  [ "${branch}" = "HEAD" ] && branch="no branch"
  [ -z "$(git status --short)" ] && color="${fg[green]}" || color="${fg[red]}"
  echo "[%{$color%}$branch%{$reset_color%}] "
}
