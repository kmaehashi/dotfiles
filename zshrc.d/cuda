# CUDA
if [ -d /usr/local/cuda ]; then
  export PATH="/usr/local/cuda/bin:${PATH}"
  export LD_LIBRARY_PATH="/usr/local/cuda/lib64:${LD_LIBRARY_PATH}"
fi

# cudnnenv (pip install cudnnenv)
if [ -L ~/.cudnn/active ]; then
  export LD_LIBRARY_PATH=~/.cudnn/active/cuda/lib64:$LD_LIBRARY_PATH
  export CPATH=~/.cudnn/active/cuda/include:$CPATH
  export LIBRARY_PATH=~/.cudnn/active/cuda/lib64:$LIBRARY_PATH
  compctl -K _cudnnenv cudnnenv
  function _cudnnenv () {
    local words completions
    read -cA words
    if [ "${#words}" -eq 2 ]; then
      completions="$(echo install,install-file,activate,uninstall,version,versions,deactivate,--help,--version | tr , '\n')"
    else
      completions="$(ls ~/.cudnn/versions)"
    fi
    reply=(${(ps:\n:)completions})
  }
fi

# ncclenv
if [ -L ~/.nccl/active ]; then
  export LD_LIBRARY_PATH=~/.nccl/active/cuda/lib64:$LD_LIBRARY_PATH
  export CPATH=~/.nccl/active/cuda/include:$CPATH
  export LIBRARY_PATH=~/.nccl/active/cuda/lib64:$LIBRARY_PATH
fi
